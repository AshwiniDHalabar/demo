---DERIVED QUIREIES---

SELECT * FROM TRANSACTION;
SELECT * FROM CUST_TRANSACTION; 
SELECT * FROM ACCOUNTSS;
INSERT INTO TRANSACTION VALUES(8,4158,'DEBIT',400,1999,'12-05-2022');

--DISPLAY THE NAMES OF THE ACCOUNT HOLDERS AND THE NUMBER OF TRANSACTIONS--
SELECT *
FROM 
    (SELECT C.CUST_NAME,COUNT(TXN_ID)AS NO_OF_TRANSACTION
    FROM TRANSACTION T,CUST_TRANSACTION C,ACCOUNTSS A
    WHERE C.CUST_BKEY=A.CUST_BKEY AND A.A_NO=T.A_NO 
    GROUP BY C.CUST_NAME)R;
    
    
--Find top 10 customers in terms of sales in the current year
SELECT *
FROM (SELECT CUST_NAME,COUNT(SALES_ID),
        DENSE_RANK() OVER (ORDER BY COUNT(SALES_ID)DESC)AS RNK
        FROM CUSTOMER_RETAIL C,SALES_RETAIL S
        WHERE C.CUST_ID = S.CUST_ID
        GROUP BY CUST_NAME)R
WHERE RNK<10;


--
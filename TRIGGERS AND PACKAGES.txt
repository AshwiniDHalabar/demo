---5..MUTATING ERROR---
--AAN EMPLOYEEE CANNOT GET SALARY THAN HIS OR HER MANAGER----
CREATE OR REPLACE TRIGGER T_EMP_SAL 
    BEFORE UPDATE 
    ON EMPLOYEE
    FOR EACH ROW
DECLARE 
PRAGMA AUTONOMOUS_TRANSACTION;
V_MGR_SAL NUMBER;
BEGIN
    SELECT V_MGR_SAL INTO V_MGR_SAL 
    FROM EMPLOYEE E,EMPLOYEE E1
    WHERE E.MGR_ID=E1.EMP_ID;
IF V_MGR_SAL<:NEW.EMP_SAL THEN
    RAISE_APPLICATION_ERROR(-20011,'UPDATED SALAMT IS GREATER THAN HIS MANAGER SAL');
END IF;
END;
    
UPDATE EMPLOYEE SET EMP_SAL=9000 WHERE EMP_ID=105; 
DESC EMPLOYEE;

 
    
SELECT  * FROM USER_TAB_COLUMNS;

--6) --WRITE A FUNCTION THAT TAKES THE TABLE NAME AND RETURN NUMBER OF COLUMNS WE HAVE IN THAT TABLE
        IF THAT TABLE NAME DOES NOT EXISTS THEN RETURN-1----
        
CREATE OR REPLACE FUNCTION FN_GET_COLUMN_COUNT(VAR_TAB_NAME VARCHAR2)RETURN NUMBER AS
N_NUM NUMBER(10);
V_CHAR VARCHAR2(200);
BEGIN
V_CHAR := 'SELECT COUNT(*) FROM USER_TAB_COLUMNS WHERE TABLE_NAME=' ||''''||VAR_TAB_NAME||'''';
EXECUTE IMMEDIATE V_CHAR INTO N_NUM;
IF N_NUM >0  THEN
RETURN N_NUM;
ELSE
RETURN '-1';
END IF;
END;


SELECT FN_GET_COLUMN_COUNT('EM') FROM DUAL;

SELECT * FROM EMP1;
SELECT * FROM DEPT1;
SELECT EMP_NAME
FROM DEPT1 D,EMP1 E
WHERE D.DEPT_ID=E.DEPT_ID AND 


--TO IDENTIFY WHICH DEPARTMENT HAS NO EMPLOYEE--
SELECT DEPT_ID
FROM DEPT1 
WHERE DEPT_ID NOT IN (SELECT DEPT_ID
FROM EMP1 
WHERE DEPT_ID IS NOT NULL);



--PACKAGE--
CREATE OR REPLACE PACKAGE PAC_EMP AS
PROCEDURE DIS;
PROCEDURE LAST_DATE;
END;
CREATE OR REPLACE PACKAGE BODY PAC_EMP AS
PROCEDURE DIS AS
BEGIN
FOR I IN 1..50 LOOP
IF MOD(I,2)=1 THEN
DBMS_OUTPUT.PUT_LINE(I);
END IF;
END LOOP;
END;

PROCEDURE LAST_DATE AS
START_DATE DATE;
END_DATE DATE;
BEGIN
START_DATE := TRUNC(SYSDATE,'YY');
END_DATE := ADD_MONTHS(START_DATE,12)-1;
while START_DATE<=END_DATE LOOP
DBMS_OUTPUT.PUT_LINE(START_DATE);
START_DATE:=START_DATE+1;
END LOOP;
END;
END;

EXEC PAC_EMP.DIS;
SET SERVEROUTPUT ON
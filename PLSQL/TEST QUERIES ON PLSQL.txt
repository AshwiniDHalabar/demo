---TO PRINT FACT OF NUMBER--
CREATE OR REPLACE PROCEDURE FACT_S AS
I NUMBER;
N NUMBER;
RES NUMBER;
BEGIN
N :=5;
I :=1;
RES :=1;
FOR I IN 1..N LOOP
RES := RES*I;
END LOOP;
DBMS_OUTPUT.PUT_LINE(RES);
END;

EXEC FACT_S
SET SERVEROUTPUT ON

----BY PASSING A STRING AND PRINT IT IN REVERSE ORDER--
CREATE OR REPLACE PROCEDURE STRING_S AS
A_S VARCHAR2(20);
BEGIN 
A_S := 'STATION';
FOR I IN REVERSE 1..LENGTH(A_S) LOOP
DBMS_OUTPUT.PUT_LINE(SUBSTR(A_S,I,1));
END LOOP;
END;

EXEC STRING_S;

---WRITE A  PROCEDURE TO DISPLAY TOP 10 PRODUCTS BASED ON SALESAMOUNT--
SELECT * FROM PRODUCT_RETAIL;
SELECT * FROM SALES_RETAIL ;

CREATE OR REPLACE PROCEDURE PRODUCT_S AS
BEGIN
FOR I IN(SELECT *
            FROM (SELECT P_NAME,SUM(AMOUNT), dense_rank() OVER (ORDER BY SUM(AMOUNT)DESC)R
            FROM PRODUCT_RETAIL P,SALES_RETAIL S
            WHERE P.PROD_ID = S.PROD_ID
            GROUP BY P_NAME)C
WHERE R<10)LOOP
DBMS_OUTPUT.PUT_LINE(I.P_NAME);
END LOOP;
END;

EXEC PRODUCT_S;

--WRITE A PROCEDURE TO INSERT THE RECORDS IN TGT TBALE FROM SCR TBALE BUT BEFORE INSERTING CHECK WHETHER IT EXITS OR NOT--
CREATE TABLE SRC1(
CUST_ID NUMBER(10),
CUST_NM VARCHAR(10),
CUST_CITY VARCHAR(10));

CREATE TABLE TGT (CUST_ID NUMBER(10),
CUST_NM VARCHAR(10),
CUST_CITY VARCHAR(10));

INSERT INTO SRC1 VALUES(11,'YASHU','BANGALORE');
INSERT INTO SRC1 VALUES(12,'ASHU','MYSORE');
INSERT INTO SRC1 VALUES(13,'LIKITH','MANDYA');

CREATE OR REPLACE PROCEDURE DATA_S AS
CURSOR GET_DATA IS (SELECT CUST_ID,CUST_NM,CUST_CITY 
                            FROM SRC1);
CN NUMBER(10);
BEGIN
FOR I IN GET_DATA LOOP
SELECT COUNT(*) INTO CN 
                    FROM TGT
                    WHERE CUST_ID=I.CUST_ID AND CUST_NM=I.CUST_NM AND CUST_CITY=I.CUST_CITY;
IF CN=0 THEN
INSERT INTO TGT VALUES(I.CUST_ID,I.CUST_NM,I.CUST_CITY);
ELSE
DBMS_OUTPUT.PUT_LINE('ALREADY EXISTS');
END IF;
END LOOP;
END;


EXEC DATA_S;

SELECT * FROM SRC1;
SELECT * FROM TGT;

select trunc(to_date('2022-12-02','yy-mm-dd')) from dual;
select trunc(to_date('2022-12-02','yy')) from dual;
select add_months(sysdate,12)-1 from dual;
--WRITE A PROCEDURE TO COUNT ALL THE SATURDAY DATES BY PASSING YEAR AT RUN TIME--
CREATE OR REPLACE PROCEDURE SAT_S(A NUMBER)AS
start_d date;
end_d date;
c number(2);
begin
start_d := to_date(a,'yy');
end_d := add_months(sysdate,1)-1;
c :=0;
while start_d<=end_d loop
if to_char(start_d,'dy') in ('sat') then
c :=c+1;
end if;
start_d :=start_d+1;
end loop;

dbms_output.put_line(c);
end;
set serveroutput on
exec sat_s(2022);